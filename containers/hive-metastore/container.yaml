name: "Hive Metastore"
slug: "hive-metastore"
summary: "Minimal Hive Metastore image using an external PostgreSQL database."
maintainers:
  - name: Platform Containers Team
    email: containers@example.com
links:
  homepage: https://hive.apache.org/
  documentation: https://github.com/seathegood/data-platform-containers/tree/main/containers/hive-metastore
  source: https://github.com/apache/hive
license: Apache-2.0
version:
  strategy: manual
  current: "4.1.0"
  notes: "Track http://dlcdn.apache.org/hive/ for new standalone metastore drops."
runtime:
  base_image: "eclipse-temurin:21-jdk-alpine"
  user: "hive"
  workdir: "/opt/hive"
  entrypoint:
    - "/usr/local/bin/entrypoint.sh"
  ports:
    - name: thrift
      container_port: 9083
      protocol: tcp
  volumes:
    - name: logs
      path: /opt/hive/logs
    - name: tmp
      path: /opt/hive/tmp
  env:
    - name: METASTORE_DB_HOST
      default: "postgres"
      description: "PostgreSQL hostname backing the metastore schema."
    - name: METASTORE_DB_PORT
      default: "5432"
      description: "PostgreSQL port for the metastore schema."
    - name: METASTORE_DB
      default: "metastore"
      description: "PostgreSQL database name for the metastore schema."
    - name: METASTORE_DB_USER
      default: "metastore"
      description: "PostgreSQL user for metastore schema migrations."
    - name: METASTORE_DB_PASSWORD
      default: ""
      description: "Password for METASTORE_DB_USER."
    - name: METASTORE_PORT
      default: "9083"
      description: "Thrift service port exposed by the metastore."
    - name: METASTORE_DB_URL
      default: ""
      description: "Optional JDBC override; generated automatically when empty."
    - name: HIVE_METASTORE_HOST
      default: "localhost"
      description: "Healthcheck override for metastore host probing."
    - name: HIVE_METASTORE_PORT
      default: "9083"
      description: "Healthcheck override for metastore port probing."
build:
  context: "."
  dockerfile: "Dockerfile"
  args:
    HIVE_VERSION: "!version.current"
    SCHEMA_VERSION: "!version.current"
    HADOOP_VERSION: "3.4.1"
    PG_JDBC_VERSION: "42.7.7"
    SLF4J_VERSION: "1.7.30"
tests:
  - name: metadata
    command: "./tests/metadata.py"
publish:
  image: "docker.io/seathegood/hive-metastore"
  tags:
    - latest
    - "!version.current"
  labels:
    org.opencontainers.image.title: "!name"
    org.opencontainers.image.version: "!version.current"
    org.opencontainers.image.description: "!summary"
    org.opencontainers.image.documentation: "https://github.com/seathegood/data-platform-containers/tree/main/containers/hive-metastore"
